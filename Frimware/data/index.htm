
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Ti RGB</title>
        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" integrity="sha384-zF4BRsG/fLiTGfR9QL82DrilZxrwgY/+du4p/c7J72zZj+FLYq4zY00RylP9ZjiT" crossorigin="anonymous">

        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                                    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-82045122-2', 'auto');
            ga('send', 'pageview');

        </script>


        <script>

            var connection  = new WebSocket('ws://192.168.0.50:81/');


            connection.onopen = function() {
                alert("Соединение установлено.");
            };

            connection.onclose = function(event) {
                if (event.wasClean) {
                    alert('Соединение закрыто чисто');
                } else {
                    alert('Обрыв соединения'); // например, "убит" процесс сервера
                }
                alert('Код: ' + event.code + ' причина: ' + event.reason);
            };

            connection.onmessage = function(event) {
                alert("Получены данные " + event.data);
            };

            connection.onerror = function(error) {
                alert("Ошибка " + error.message);
            };

            function SendVar(pref,val)
            {
                connection.send(pref+val);
            }	
            function SendPref(val)
            {
                connection.send(val);
            }

            function RgbGlob(vval)
            {
                SendVar('red',vval);
                SendVar('green',vval);
                SendVar('blue',vval);
            }



            function hexToRgb(hex) {
                var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
                return result ? {
                    r: parseInt(result[1], 16),
                    g: parseInt(result[2], 16),
                    b: parseInt(result[3], 16)
                } : null;
            }			

            function sendColor(newValue)
            {
                var RGBColor = hexToRgb(newValue);
                console.log(RGBColor);
                SendVar('red',(Math.round(RGBColor.r)));
                SendVar('green',(Math.round(RGBColor.g)));
                SendVar('blue',(Math.round(RGBColor.b)));
            }
        </script> 	    

    </head>
    <body>
        <div class="container">
            <center><h1>Ti RGB</h1></center>
            <div class="panel panel-success">
                <div class="panel-heading">Цветная лента</div>
                <div class="panel-body">
                    <p>
                        Красный
                        <input type="range" id="slider3-range" value="0" min="0" max="255" oninput="SendVar('red',this.value)"
                               step="5" />
                        Зеленый
                        <input type="range" id="slider1-range" value="0" min="0" max="255" oninput="SendVar('green',this.value)"
                               data-highlight="true" />
                        Синий
                        <input type="range" id="slider2-range" value="0" min="0" max="255" oninput="SendVar('blue',this.value)"
                               step="5" data-highlight="true" />
                        Выбрать цвет
                        <input type="color" id="html5colorpicker" onchange="sendColor(this.value)" value="#ff0000" >
                    </p>

                    <p>
                        <button type="button" class="btn btn-primary " data-toggle="modal" data-target="#myModal">
                            Режимы
                        </button>

                        <button type="button" onclick="RgbGlob(255)" class="btn btn-default " >
                            Вкл
                        </button>
                        <button type="button" onclick="RgbGlob(0)" class="btn btn-default " >
                            Выкл
                        </button>



                    </p>
                </div>
            </div>




            <div class="panel panel-info">
                <div class="panel-heading">Точечный свет</div>
                <div class="panel-body">
                    <p>
                        <button type="button" onclick="LedOn()" class="btn btn-default ">
                            Вкл все
                        </button>
                        <button type="button" onclick="SendVar('led',4)" class="btn btn-default " >
                            Выкл все
                        </button>
                    </p>
                    <p>
                        <button type="button" onclick="SendVar('led',0)"  class="btn btn-default " >
                            Свет 1
                        </button>
                        <button type="button" onclick="SendVar('led',1)" class="btn btn-default " >
                            Свет 2
                        </button>
                        <button type="button" onclick="LedOn()" class="btn btn-default ">
                            Свет 3
                        </button>
                        <button type="button" onclick="LedOn()" class="btn btn-default " >
                            Свет 4
                        </button>
                    </p>
                </div>
            </div>


            <div class="panel panel-danger">
                <div class="panel-heading">Свето лента</div>
                <div class="panel-body">
                    <p>
                        Температура 
                        <input type="range" id="slider3-range" value="0" min="0" max="1023" oninput="showValueB(this.value)"
                               step="5" />
                        Яркость 
                        <input type="range" id="slider3-range" value="0" min="0" max="1023" oninput="showValueB(this.value)"
                               step="5" />

                    </p>
                    <p>
                        <button type="button" class="btn btn-default " >
                            Вкл
                        </button>
                        <button type="button" class="btn btn-default " >
                            Выкл
                        </button>
                    </p>
                </div>
            </div>


            <div class="panel panel-Warning">
                <div class="panel-heading">Глобально</div>
                <div class="panel-body">

                    <p>

                        <button type="button" class="btn btn-default " >
                            Выкл все
                        </button>
                        <button type="button" class="btn btn-default " >
                            Перезагрузка
                        </button>

                    </p>
                </div>
            </div>


        </div>

        <!-- Button triggers  -->


        <!-- Rainbow Modal -->
        <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="myModalLabel">Режимы</h4>
                    </div>
                    <div class="modal-body">

                        <button type="button" onclick="SendVar('mode',1)" class="btn btn-primary ">
                            Радуга
                        </button>

                        <button type="button" onclick="SendVar('mode',2)" class="btn btn-primary " >
                            Мигание
                        </button>

                        <button type="button" onclick="SendVar('mode',3))" class="btn btn-primary " >
                            Затухание
                        </button>

                        <button type="button" onclick="SendVar('mode',4)" class="btn btn-primary " >
                            Музыка
                        </button>


                        <br>
                        <label for="slider3-range">Скорость</label>
                        <input type="range" id="slider3-range" value="0" min="1" max="2000" oninput="SendVar('t',this.value)"
                               step="5" data-highlight="true" />
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Закрыть</button>
                    </div>
                </div>
            </div>
        </div>













        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    </body>
</html>