
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Ti RGB</title>

        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" integrity="sha384-zF4BRsG/fLiTGfR9QL82DrilZxrwgY/+du4p/c7J72zZj+FLYq4zY00RylP9ZjiT" crossorigin="anonymous">


        <script>

            var connection = new WebSocket('ws://'+location.hostname+':81/')

            connection.onerror = function(error) {
                alert("ERROR " + error.message);
            };

            function SendVar(pref,val)
            {
                connection.send(pref+val);
            }	
            function SendPref(val)
            {
                connection.send(val);
            }

            function RgbGlob(vval)
            {
                SendVar('red',vval);
                SendVar('green',vval);
                SendVar('blue',vval);
            }

            function hexToRgb(hex) {
                var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
                return result ? {
                    r: parseInt(result[1], 16),
                    g: parseInt(result[2], 16),
                    b: parseInt(result[3], 16)
                } : null;
            }			

            function sendColor(newValue)
            {
                var RGBColor = hexToRgb(newValue);
                console.log(RGBColor);
                SendVar('red',(Math.round(RGBColor.r)));
                SendVar('green',(Math.round(RGBColor.g)));
                SendVar('blue',(Math.round(RGBColor.b)));
            }
        </script> 	    

    </head>
    <body>
        <div class="container">
            <center><h1>Ti RGB</h1></center>
            <div class="panel panel-success">
                <div class="panel-heading">RGB strip</div>
                <div class="panel-body">
                    <p>
                        Red
                        <input type="range" id="slider3-range" value="0" min="0" max="255" oninput="SendVar('red',this.value)"
                               step="5" />
                        Green
                        <input type="range" id="slider1-range" value="0" min="0" max="255" oninput="SendVar('green',this.value)"
                               data-highlight="true" />
                        Blue
                        <input type="range" id="slider2-range" value="0" min="0" max="255" oninput="SendVar('blue',this.value)"
                               step="5" data-highlight="true" />
                        Pick color
                        <input type="color" id="html5colorpicker" onchange="sendColor(this.value)" value="#ff0000" >
                    </p>

                    <p>
                        <button type="button" class="btn btn-primary " data-toggle="modal" data-target="#myModal">
                            Mode
                        </button>

                        <button type="button" onclick="RgbGlob(255)" class="btn btn-default " >
                            On
                        </button>
                        <button type="button" onclick="RgbGlob(0)" class="btn btn-default " >
                            Off
                        </button>



                    </p>
                </div>
            </div>




            <div class="panel panel-info">
                <div class="panel-heading">Точечный свет</div>
                <div class="panel-body">
                    <p>
                        <button type="button" onclick="LedOn()" class="btn btn-default ">
                            All ON
                        </button>
                        <button type="button" onclick="SendVar('led',4)" class="btn btn-default " >
                            ALL OFF
                        </button>
                    </p>
                    <p>
                        <button type="button" onclick="SendVar('led',0)"  class="btn btn-default " >
                            Light 1
                        </button>
                        <button type="button" onclick="SendVar('led',1)" class="btn btn-default " >
                            Light 2
                        </button>
                        <button type="button" onclick="LedOn()" class="btn btn-default ">
                            Light 3
                        </button>
                        <button type="button" onclick="LedOn()" class="btn btn-default " >
                            Light 4
                        </button>
                    </p>
                </div>
            </div>


            <div class="panel panel-danger">
                <div class="panel-heading">White strip</div>
                <div class="panel-body">
                    <p>
                        Temp 
                        <input type="range" id="slider3-range" value="0" min="0" max="1023" oninput="showValueB(this.value)"
                               step="5" />

                        Brightness 
                        <input type="range" id="slider3-range" value="0" min="0" max="1023" oninput="showValueB(this.value)"
                               step="5" />

                    </p>
                    <p>
                        <button type="button" class="btn btn-default " >
                            On
                        </button>
                        <button type="button" class="btn btn-default " >
                            Off
                        </button>
                    </p>
                </div>
            </div>


            <div class="panel panel-Warning">
                <div class="panel-heading">Global</div>
                <div class="panel-body">

                    <p>
                        <button type="button" class="btn btn-default " >
                            Off all
                        </button>
                        <button type="button" class="btn btn-default " >
                            Reboot
                        </button>
                        <button type="button" href="/upd" class="btn btn-default " >
                            Update
                        </button>
                        <button type="button" href="/edit.htm" class="btn btn-default " >
                            Editor
                        </button>
                    </p>
                </div>
            </div>


        </div>

        <!-- Button triggers  -->


        <!-- Rainbow Modal -->
        <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="myModalLabel">Mode</h4>
                    </div>
                    <div class="modal-body">

                        <button type="button" onclick="SendVar('mode',1)" class="btn btn-primary ">
                            Rainbow
                        </button>

                        <button type="button" onclick="SendVar('mode',2)" class="btn btn-primary " >
                            Blink
                        </button>

                        <button type="button" onclick="SendVar('mode',3))" class="btn btn-primary " >
                            Fade
                        </button>

                        <button type="button" onclick="SendVar('mode',4)" class="btn btn-primary " >
                            Music
                        </button>


                        <br>
                        <label for="slider3-range">Speed</label>
                        <input type="range" id="slider3-range" value="0" min="1" max="2000" oninput="SendVar('t',this.value)"
                               step="5" data-highlight="true" />
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>







        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    </body>
</html>