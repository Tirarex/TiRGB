
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Ti RGB</title>

        <script>

            var connection = new WebSocket('ws://'+location.hostname+':81/')

            connection.onerror = function(error) {
                alert("ERROR " + error.message);
            };

            function SendVar(pref,val)
            {
                connection.send(pref+val);
            }	
            function SendPref(val)
            {
                connection.send(val);
            }

            function RgbGlob(vval)
            {
                SendVar('red',vval);
                SendVar('green',vval);
                SendVar('blue',vval);
            }

            function hexToRgb(hex) {
                var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
                return result ? {
                    r: parseInt(result[1], 16),
                    g: parseInt(result[2], 16),
                    b: parseInt(result[3], 16)
                } : null;
            }			

            function sendColor(newValue)
            {
                var RGBColor = hexToRgb(newValue);
                console.log(RGBColor);
                SendVar('red',(Math.round(RGBColor.r)));
                SendVar('green',(Math.round(RGBColor.g)));
                SendVar('blue',(Math.round(RGBColor.b)));
            }
        </script> 	    

    </head>
    <body>

        <center><h1>Ti RGB</h1></center>

        <p>
            Red
            <input type="range" id="slider3-range" value="0" min="0" max="255" oninput="SendVar('red',this.value)"
                   step="5" />
            Green
            <input type="range" id="slider1-range" value="0" min="0" max="255" oninput="SendVar('green',this.value)"
                   data-highlight="true" />
            Blue
            <input type="range" id="slider2-range" value="0" min="0" max="255" oninput="SendVar('blue',this.value)"
                   step="5" data-highlight="true" />

            <br>
            Pick color
            <input type="color" id="html5colorpicker" onchange="sendColor(this.value)" value="#ff0000" >
        </p>

        <details>
            <summary>Mode</summary>
            <button type="button" onclick="SendVar('mode',1)" class="btn btn-primary ">
                Rainbow
            </button>

            <button type="button" onclick="SendVar('mode',2)" class="btn btn-primary " >
                Blink
            </button>

            <button type="button" onclick="SendVar('mode',3))" class="btn btn-primary " >
                Fade
            </button>

            <button type="button" onclick="SendVar('mode',4)" class="btn btn-primary " >
                Music
            </button>


            <br>

            <label for="slider3-range">Speed</label>
            <input type="range" id="slider3-range" value="0" min="1" max="2000" oninput="SendVar('t',this.value)"
                   step="5" data-highlight="true" />
        </details>





        <p>
            <button type="button" onclick="RgbGlob(255)" class="btn btn-default " >
                On
            </button>
            <button type="button" onclick="RgbGlob(0)" class="btn btn-default " >
                Off
            </button>
        </p>


        <p>
            <button type="button" onclick="LedOn()" class="btn btn-default ">
                All ON
            </button>
            <button type="button" onclick="SendVar('led',4)" class="btn btn-default " >
                ALL OFF
            </button>
        </p>
        <p>
            <button type="button" onclick="SendVar('led',0)"  class="btn btn-default " >
                Light 1
            </button>
            <button type="button" onclick="SendVar('led',1)" class="btn btn-default " >
                Light 2
            </button>
            <button type="button" onclick="LedOn()" class="btn btn-default ">
                Light 3
            </button>
            <button type="button" onclick="LedOn()" class="btn btn-default " >
                Light 4
            </button>
        </p>



        <p>
            Temp 
            <input type="range" id="slider3-range" value="0" min="0" max="1023" oninput="showValueB(this.value)"
                   step="5" />
            <br>
            Brightness 
            <input type="range" id="slider3-range" value="0" min="0" max="1023" oninput="showValueB(this.value)"
                   step="5" />

        </p>
        <p>
            <button type="button" class="btn btn-default " >
                On
            </button>
            <button type="button" class="btn btn-default " >
                Off
            </button>
        </p>




        <p>
            <button type="button" class="btn btn-default " >
                Off all
            </button>
            <button type="button" class="btn btn-default " >
                Reboot
            </button>
            <button type="button" href="/upd" class="btn btn-default " >
                Update
            </button>
            <button type="button" href="/edit.htm" class="btn btn-default " >
                Editor
            </button>
        </p>



    </body>
</html>